// 加载器组件样式
@use '../abstracts/variables' as *;
@use '../abstracts/mixins' as *;

.loader {
  // 基础加载器
  &__spinner {
    @include loading-spinner;
    margin: 0 auto;
  }
  
  // 大尺寸加载器
  &__spinner--lg {
    @include loading-spinner(32px, $primary-color);
  }
  
  // 小尺寸加载器
  &__spinner--sm {
    @include loading-spinner(16px, $primary-color);
  }
  
  // 内联加载器
  &__inline {
    display: inline-flex;
    align-items: center;
    gap: $spacing-sm;
    
    .loader__spinner {
      @include loading-spinner(16px, $primary-color);
    }
    
    .loader__text {
      font-size: $font-size-sm;
      color: $text-secondary;
    }
  }
  
  // 全屏加载器
  &__fullscreen {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba($bg-primary, 0.9);
    @include center-align;
    flex-direction: column;
    gap: $spacing-lg;
    z-index: $z-index-modal;
    
    .loader__spinner {
      @include loading-spinner(48px, $primary-color);
    }
    
    .loader__text {
      font-size: $font-size-lg;
      font-weight: $font-weight-medium;
      color: $text-primary;
    }
    
    .loader__subtext {
      font-size: $font-size-base;
      color: $text-secondary;
      text-align: center;
      max-width: 300px;
    }
  }
  
  // 区块加载器
  &__block {
    @include center-align;
    flex-direction: column;
    gap: $spacing-md;
    padding: $spacing-xl;
    min-height: 200px;
    
    .loader__spinner {
      @include loading-spinner(32px, $primary-color);
    }
    
    .loader__text {
      font-size: $font-size-base;
      color: $text-secondary;
      text-align: center;
    }
  }
  
  // 点状加载器
  &__dots {
    display: inline-flex;
    gap: $spacing-xs;
    
    .dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: $primary-color;
      animation: dots-loading 1.4s ease-in-out infinite both;
      
      &:nth-child(1) {
        animation-delay: -0.32s;
      }
      
      &:nth-child(2) {
        animation-delay: -0.16s;
      }
    }
  }
  
  // 脉冲加载器
  &__pulse {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: $primary-color;
    animation: pulse-loading 1.5s ease-in-out infinite;
  }
  
  // 条状加载器
  &__bars {
    display: inline-flex;
    gap: 3px;
    align-items: end;
    
    .bar {
      width: 4px;
      height: 20px;
      background-color: $primary-color;
      border-radius: $border-radius-pill;
      animation: bars-loading 1.2s ease-in-out infinite;
      
      &:nth-child(1) {
        animation-delay: -1.1s;
      }
      
      &:nth-child(2) {
        animation-delay: -1.0s;
      }
      
      &:nth-child(3) {
        animation-delay: -0.9s;
      }
      
      &:nth-child(4) {
        animation-delay: -0.8s;
      }
      
      &:nth-child(5) {
        animation-delay: -0.7s;
      }
    }
  }
  
  // 骨架屏加载器
  &__skeleton {
    .skeleton-item {
      background: linear-gradient(
        90deg,
        $bg-secondary 25%,
        $bg-tertiary 50%,
        $bg-secondary 75%
      );
      background-size: 200% 100%;
      animation: skeleton-loading 1.5s ease-in-out infinite;
      border-radius: $border-radius-base;
      
      &--line {
        height: 16px;
        margin-bottom: $spacing-sm;
        
        &:last-child {
          margin-bottom: 0;
          width: 60%;
        }
      }
      
      &--title {
        height: 24px;
        margin-bottom: $spacing-md;
        width: 80%;
      }
      
      &--avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        margin-bottom: $spacing-md;
      }
      
      &--button {
        height: 36px;
        width: 100px;
        border-radius: $border-radius-base;
      }
      
      &--card {
        height: 200px;
        width: 100%;
        margin-bottom: $spacing-lg;
      }
    }
  }
  
  // 进度条加载器
  &__progress {
    width: 100%;
    max-width: 300px;
    
    &-track {
      width: 100%;
      height: 4px;
      background-color: $bg-secondary;
      border-radius: $border-radius-pill;
      overflow: hidden;
    }
    
    &-bar {
      height: 100%;
      background-color: $primary-color;
      border-radius: $border-radius-pill;
      transition: width $transition-base;
      
      &--indeterminate {
        width: 30%;
        animation: progress-indeterminate 2s linear infinite;
      }
    }
    
    &-text {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: $spacing-xs;
      font-size: $font-size-sm;
      color: $text-secondary;
    }
  }
}

// 加载器动画
@keyframes dots-loading {
  0%, 80%, 100% {
    transform: scale(0);
    opacity: 0.5;
  }
  40% {
    transform: scale(1);
    opacity: 1;
  }
}

@keyframes pulse-loading {
  0% {
    transform: scale(0);
    opacity: 1;
  }
  100% {
    transform: scale(1);
    opacity: 0;
  }
}

@keyframes bars-loading {
  0%, 40%, 100% {
    transform: scaleY(0.4);
  }
  20% {
    transform: scaleY(1);
  }
}

@keyframes skeleton-loading {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

@keyframes progress-indeterminate {
  0% {
    transform: translateX(-100%);
  }
  100% {
    transform: translateX(333%);
  }
}

// 加载器主题变体
.loader {
  &--primary {
    .loader__spinner,
    .loader__dots .dot,
    .loader__pulse,
    .loader__bars .bar,
    .loader__progress-bar {
      background-color: $primary-color;
    }
    
    .loader__spinner {
      border-top-color: $primary-color;
    }
  }
  
  &--secondary {
    .loader__spinner,
    .loader__dots .dot,
    .loader__pulse,
    .loader__bars .bar,
    .loader__progress-bar {
      background-color: $secondary-color;
    }
    
    .loader__spinner {
      border-top-color: $secondary-color;
    }
  }
  
  &--success {
    .loader__spinner,
    .loader__dots .dot,
    .loader__pulse,
    .loader__bars .bar,
    .loader__progress-bar {
      background-color: $success-color;
    }
    
    .loader__spinner {
      border-top-color: $success-color;
    }
  }
}

// 响应式调整
@media (max-width: #{$breakpoint-md - 1px}) {
  .loader {
    &__fullscreen {
      .loader__text {
        font-size: $font-size-base;
      }
      
      .loader__subtext {
        font-size: $font-size-sm;
      }
    }
    
    &__block {
      padding: $spacing-lg;
      min-height: 150px;
    }
  }
}